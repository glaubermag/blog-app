var P=s=>{throw TypeError(s)};var S=(s,t,r)=>t.has(s)||P("Cannot "+r);var l=(s,t,r)=>(S(s,t,"read from private field"),r?r.call(s):t.get(s)),f=(s,t,r)=>t.has(s)?P("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,r),k=(s,t,r,i)=>(S(s,t,"write to private field"),i?i.call(s,r):t.set(s,r),r),v=(s,t,r)=>(S(s,t,"access private method"),r);import{S as W,s as z,h as F,g as B,n as T,u as V,r as N,j as e,a as G,R as H,b as y,L as K}from"./index-AtdNiWgq.js";import{n as J,s as X,u as O,E as q,U as R,c as Y,b as Z,d as _,e as $}from"./ErrorMessage-BjBGCUQE.js";var m,h,n,c,u,C,L,I,ee=(I=class extends W{constructor(t,r){super();f(this,u);f(this,m);f(this,h);f(this,n);f(this,c);k(this,m,t),this.setOptions(r),this.bindMethods(),v(this,u,C).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var i;const r=this.options;this.options=l(this,m).defaultMutationOptions(t),z(this.options,r)||l(this,m).getMutationCache().notify({type:"observerOptionsUpdated",mutation:l(this,n),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&F(r.mutationKey)!==F(this.options.mutationKey)?this.reset():((i=l(this,n))==null?void 0:i.state.status)==="pending"&&l(this,n).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=l(this,n))==null||t.removeObserver(this)}onMutationUpdate(t){v(this,u,C).call(this),v(this,u,L).call(this,t)}getCurrentResult(){return l(this,h)}reset(){var t;(t=l(this,n))==null||t.removeObserver(this),k(this,n,void 0),v(this,u,C).call(this),v(this,u,L).call(this)}mutate(t,r){var i;return k(this,c,r),(i=l(this,n))==null||i.removeObserver(this),k(this,n,l(this,m).getMutationCache().build(l(this,m),this.options)),l(this,n).addObserver(this),l(this,n).execute(t)}},m=new WeakMap,h=new WeakMap,n=new WeakMap,c=new WeakMap,u=new WeakSet,C=function(){var r;const t=((r=l(this,n))==null?void 0:r.state)??B();k(this,h,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},L=function(t){T.batch(()=>{var r,i,o,a,x,p,j,w;if(l(this,c)&&this.hasListeners()){const d=l(this,h).variables,g=l(this,h).context;(t==null?void 0:t.type)==="success"?((i=(r=l(this,c)).onSuccess)==null||i.call(r,t.data,d,g),(a=(o=l(this,c)).onSettled)==null||a.call(o,t.data,null,d,g)):(t==null?void 0:t.type)==="error"&&((p=(x=l(this,c)).onError)==null||p.call(x,t.error,d,g),(w=(j=l(this,c)).onSettled)==null||w.call(j,void 0,t.error,d,g))}this.listeners.forEach(d=>{d(l(this,h))})})},I);function te(s,t){const r=V(),[i]=N.useState(()=>new ee(r,s));N.useEffect(()=>{i.setOptions(s)},[i,s]);const o=N.useSyncExternalStore(N.useCallback(x=>i.subscribe(T.batchCalls(x)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),a=N.useCallback((x,p)=>{i.mutate(x,p).catch(J)},[i]);if(o.error&&X(i.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:a,mutateAsync:o.mutate}}const se=({comment:s,onChange:t,onSubmit:r,isLoading:i})=>{const o=a=>{a.preventDefault(),r(s)};return e.jsxs("form",{onSubmit:o,className:"space-y-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome"}),e.jsx("input",{type:"text",id:"name",value:s.name,onChange:a=>t({...s,name:a.target.value}),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:s.email,onChange:a=>t({...s,email:a.target.value}),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"body",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Comentário"}),e.jsx("textarea",{id:"body",value:s.body,onChange:a=>t({...s,body:a.target.value}),rows:4,className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",required:!0})]}),e.jsx("button",{type:"submit",disabled:i,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?"Enviando...":"Enviar Comentário"})]})},re=({comments:s})=>s.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Nenhum comentário ainda. Seja o primeiro a comentar!"})}):e.jsx("div",{className:"space-y-6",children:s.map(t=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 font-medium",children:t.name.charAt(0)})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.email})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-300",children:t.body})]})]})},t.id))}),ne=()=>{const{id:s}=G(),t=parseInt(s||"0"),r=V(),[i,o]=H.useState({name:"",email:"",body:""}),{data:a,isLoading:x,error:p}=O({queryKey:["post",t],queryFn:()=>Z(t),gcTime:1e3*60*30,staleTime:1e3*60*5}),{data:j,isLoading:w,error:d}=O({queryKey:["author",a==null?void 0:a.userId],queryFn:()=>_((a==null?void 0:a.userId)||0),enabled:!!(a!=null&&a.userId),gcTime:1e3*60*30,staleTime:1e3*60*5,retry:(b,E)=>E instanceof R?!1:b<3}),{data:g=[],isLoading:D,error:U}=O({queryKey:["comments",t],queryFn:()=>$(t),gcTime:1e3*60*30,staleTime:1e3*60*5}),M=te({mutationFn:b=>Y(t,b),onSuccess:b=>{r.setQueryData(["comments",t],E=>{const Q={...b,id:Date.now(),postId:t};return[...E||[],Q]}),o({name:"",email:"",body:""})}}),A=b=>{M.mutate(b)};return x?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsx(K,{})]})}):p?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsx(q,{message:"Erro ao carregar o post. Por favor, tente novamente mais tarde."})]})}):a?w||D?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:a.title}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:a.body})]}),e.jsx(K,{})]})}):d instanceof R?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:a.title}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:a.body})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Autor não encontrado"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Desculpe, não conseguimos encontrar o autor deste post."})]})]})}):d||U?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:a.title}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:a.body})]}),e.jsx(q,{message:"Ocorreu um erro ao carregar os dados. Por favor, tente novamente mais tarde."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:a.title}),j&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Por: ",j.name]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-500 text-sm",children:j.email})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:a.body})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-6",children:["Comentários (",g.length,")"]}),e.jsx(se,{comment:i,onChange:o,onSubmit:A,isLoading:M.isPending}),e.jsx(re,{comments:g})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsx(q,{message:"Post não encontrado."})]})})};export{ne as default};
