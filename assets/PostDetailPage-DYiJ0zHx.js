var F=s=>{throw TypeError(s)};var S=(s,t,r)=>t.has(s)||F("Cannot "+r);var n=(s,t,r)=>(S(s,t,"read from private field"),r?r.call(s):t.get(s)),f=(s,t,r)=>t.has(s)?F("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(s):t.set(s,r),k=(s,t,r,i)=>(S(s,t,"write to private field"),i?i.call(s,r):t.set(s,r),r),v=(s,t,r)=>(S(s,t,"access private method"),r);import{S as W,s as z,h as I,g as B,n as V,u as D,r as w,j as e,a as G,R as H,b as y,L as K}from"./index-Y9oe5jAO.js";import{n as J,s as X,u as O,E as q,U as R,c as Y,b as Z,d as _,e as $}from"./ErrorMessage-BSGGTTcV.js";var h,g,l,u,x,E,L,T,ee=(T=class extends W{constructor(t,r){super();f(this,x);f(this,h);f(this,g);f(this,l);f(this,u);k(this,h,t),this.setOptions(r),this.bindMethods(),v(this,x,E).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var i;const r=this.options;this.options=n(this,h).defaultMutationOptions(t),z(this.options,r)||n(this,h).getMutationCache().notify({type:"observerOptionsUpdated",mutation:n(this,l),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&I(r.mutationKey)!==I(this.options.mutationKey)?this.reset():((i=n(this,l))==null?void 0:i.state.status)==="pending"&&n(this,l).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=n(this,l))==null||t.removeObserver(this)}onMutationUpdate(t){v(this,x,E).call(this),v(this,x,L).call(this,t)}getCurrentResult(){return n(this,g)}reset(){var t;(t=n(this,l))==null||t.removeObserver(this),k(this,l,void 0),v(this,x,E).call(this),v(this,x,L).call(this)}mutate(t,r){var i;return k(this,u,r),(i=n(this,l))==null||i.removeObserver(this),k(this,l,n(this,h).getMutationCache().build(n(this,h),this.options)),n(this,l).addObserver(this),n(this,l).execute(t)}},h=new WeakMap,g=new WeakMap,l=new WeakMap,u=new WeakMap,x=new WeakSet,E=function(){var r;const t=((r=n(this,l))==null?void 0:r.state)??B();k(this,g,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},L=function(t){V.batch(()=>{var r,i,o,a,m,p,j,C;if(n(this,u)&&this.hasListeners()){const d=n(this,g).variables,b=n(this,g).context;(t==null?void 0:t.type)==="success"?((i=(r=n(this,u)).onSuccess)==null||i.call(r,t.data,d,b),(a=(o=n(this,u)).onSettled)==null||a.call(o,t.data,null,d,b)):(t==null?void 0:t.type)==="error"&&((p=(m=n(this,u)).onError)==null||p.call(m,t.error,d,b),(C=(j=n(this,u)).onSettled)==null||C.call(j,void 0,t.error,d,b))}this.listeners.forEach(d=>{d(n(this,g))})})},T);function te(s,t){const r=D(),[i]=w.useState(()=>new ee(r,s));w.useEffect(()=>{i.setOptions(s)},[i,s]);const o=w.useSyncExternalStore(w.useCallback(m=>i.subscribe(V.batchCalls(m)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),a=w.useCallback((m,p)=>{i.mutate(m,p).catch(J)},[i]);if(o.error&&X(i.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:a,mutateAsync:o.mutate}}const se=({comment:s,onChange:t,onSubmit:r,isLoading:i})=>{const o=a=>{a.preventDefault(),r(s)};return e.jsxs("form",{onSubmit:o,className:"space-y-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome"}),e.jsx("input",{type:"text",id:"name",value:s.name,onChange:a=>t({...s,name:a.target.value}),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:s.email,onChange:a=>t({...s,email:a.target.value}),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"body",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Comentário"}),e.jsx("textarea",{id:"body",value:s.body,onChange:a=>t({...s,body:a.target.value}),rows:4,className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",required:!0})]}),e.jsx("button",{type:"submit",disabled:i,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?"Enviando...":"Enviar Comentário"})]})},re=({comments:s})=>s.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Nenhum comentário ainda. Seja o primeiro a comentar!"})}):e.jsx("div",{className:"space-y-6",children:s.map(t=>e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 font-medium",children:t.name.charAt(0)})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.name}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.email})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-300",children:t.body})]})]})},t.id))}),le=()=>{const{id:s}=G(),t=parseInt(s||"0"),r=D(),[i,o]=H.useState({name:"",email:"",body:""}),{data:a,isLoading:m,error:p}=O({queryKey:["post",t],queryFn:()=>Z(t),gcTime:1e3*60*30,staleTime:1e3*60*5}),{data:j,isLoading:C,error:d}=O({queryKey:["author",a==null?void 0:a.userId],queryFn:()=>_((a==null?void 0:a.userId)||0),enabled:!!(a!=null&&a.userId),gcTime:1e3*60*30,staleTime:1e3*60*5,retry:(c,N)=>N instanceof R?!1:c<3}),{data:b=[],isLoading:U,error:A}=O({queryKey:["comments",t],queryFn:()=>$(t).then(c=>c.sort((N,P)=>P.id-N.id)),gcTime:1e3*60*30,staleTime:1e3*60*5}),M=te({mutationFn:c=>Y(t,c),onSuccess:c=>{r.setQueryData(["comments",t],N=>[{...c,id:Date.now(),postId:t},...N||[]]),o({name:"",email:"",body:""})}}),Q=c=>{M.mutate(c)};return m?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsx(K,{})]})}):p?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsx(q,{message:"Erro ao carregar o post. Por favor, tente novamente mais tarde."})]})}):a?C||U?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:a.title}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:a.body})]}),e.jsx(K,{})]})}):d instanceof R?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:a.title}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:a.body})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Autor não encontrado"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Desculpe, não conseguimos encontrar o autor deste post."})]})]})}):d||A?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:a.title}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:a.body})]}),e.jsx(q,{message:"Ocorreu um erro ao carregar os dados. Por favor, tente novamente mais tarde."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:a.title}),j&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Por: ",j.name]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-500 text-sm",children:j.email})]}),e.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:a.body})]}),e.jsxs("section",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-6",children:["Comentários (",b.length,")"]}),e.jsx(se,{comment:i,onChange:o,onSubmit:Q,isLoading:M.isPending}),e.jsx(re,{comments:b})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx(y,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),e.jsx(q,{message:"Post não encontrado."})]})})};export{le as default};
