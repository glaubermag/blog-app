var M=s=>{throw TypeError(s)};var E=(s,e,r)=>e.has(s)||M("Cannot "+r);var n=(s,e,r)=>(E(s,e,"read from private field"),r?r.call(s):e.get(s)),p=(s,e,r)=>e.has(s)?M("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,r),j=(s,e,r,a)=>(E(s,e,"write to private field"),a?a.call(s,r):e.set(s,r),r),v=(s,e,r)=>(E(s,e,"access private method"),r);import{S as T,s as W,h as P,g as z,n as I,u as D,r as k,j as t,a as B,R as G,L as H,b as F}from"./index-DcCohCzJ.js";import{n as J,s as X,u as S,E as O,U as K,c as Y,b as Z,d as _,e as $}from"./ErrorMessage-DNHFwpNq.js";var m,x,o,u,c,w,q,R,ee=(R=class extends T{constructor(e,r){super();p(this,c);p(this,m);p(this,x);p(this,o);p(this,u);j(this,m,e),this.setOptions(r),this.bindMethods(),v(this,c,w).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){var a;const r=this.options;this.options=n(this,m).defaultMutationOptions(e),W(this.options,r)||n(this,m).getMutationCache().notify({type:"observerOptionsUpdated",mutation:n(this,o),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&P(r.mutationKey)!==P(this.options.mutationKey)?this.reset():((a=n(this,o))==null?void 0:a.state.status)==="pending"&&n(this,o).setOptions(this.options)}onUnsubscribe(){var e;this.hasListeners()||(e=n(this,o))==null||e.removeObserver(this)}onMutationUpdate(e){v(this,c,w).call(this),v(this,c,q).call(this,e)}getCurrentResult(){return n(this,x)}reset(){var e;(e=n(this,o))==null||e.removeObserver(this),j(this,o,void 0),v(this,c,w).call(this),v(this,c,q).call(this)}mutate(e,r){var a;return j(this,u,r),(a=n(this,o))==null||a.removeObserver(this),j(this,o,n(this,m).getMutationCache().build(n(this,m),this.options)),n(this,o).addObserver(this),n(this,o).execute(e)}},m=new WeakMap,x=new WeakMap,o=new WeakMap,u=new WeakMap,c=new WeakSet,w=function(){var r;const e=((r=n(this,o))==null?void 0:r.state)??z();j(this,x,{...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset})},q=function(e){I.batch(()=>{var r,a,l,i,h,y,f,N;if(n(this,u)&&this.hasListeners()){const d=n(this,x).variables,g=n(this,x).context;(e==null?void 0:e.type)==="success"?((a=(r=n(this,u)).onSuccess)==null||a.call(r,e.data,d,g),(i=(l=n(this,u)).onSettled)==null||i.call(l,e.data,null,d,g)):(e==null?void 0:e.type)==="error"&&((y=(h=n(this,u)).onError)==null||y.call(h,e.error,d,g),(N=(f=n(this,u)).onSettled)==null||N.call(f,void 0,e.error,d,g))}this.listeners.forEach(d=>{d(n(this,x))})})},R);function te(s,e){const r=D(),[a]=k.useState(()=>new ee(r,s));k.useEffect(()=>{a.setOptions(s)},[a,s]);const l=k.useSyncExternalStore(k.useCallback(h=>a.subscribe(I.batchCalls(h)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),i=k.useCallback((h,y)=>{a.mutate(h,y).catch(J)},[a]);if(l.error&&X(a.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:i,mutateAsync:l.mutate}}const se=({comment:s,onChange:e,onSubmit:r,isLoading:a})=>{const l=i=>{i.preventDefault(),r(s)};return t.jsxs("form",{onSubmit:l,className:"space-y-4 mb-8",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nome"}),t.jsx("input",{type:"text",id:"name",value:s.name,onChange:i=>e({...s,name:i.target.value}),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),t.jsx("input",{type:"email",id:"email",value:s.email,onChange:i=>e({...s,email:i.target.value}),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"body",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Comentário"}),t.jsx("textarea",{id:"body",value:s.body,onChange:i=>e({...s,body:i.target.value}),rows:4,className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 transition-colors",required:!0})]}),t.jsx("button",{type:"submit",disabled:a,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?"Enviando...":"Enviar Comentário"})]})},re=({comments:s})=>s.length===0?t.jsx("div",{className:"text-center py-8",children:t.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Nenhum comentário ainda. Seja o primeiro a comentar!"})}):t.jsx("div",{className:"space-y-6",children:s.map(e=>t.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300 font-medium",children:e.name.charAt(0)})}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name}),t.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.email})]}),t.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-300",children:e.body})]})]})},e.id))}),oe=()=>{const{id:s}=B(),e=parseInt(s||"0"),r=D(),[a,l]=G.useState({name:"",email:"",body:""}),{data:i,isLoading:h,error:y}=S({queryKey:["post",e],queryFn:()=>Z(e)}),{data:f,isLoading:N,error:d}=S({queryKey:["author",i==null?void 0:i.userId],queryFn:()=>_((i==null?void 0:i.userId)||0),enabled:!!(i!=null&&i.userId),retry:(b,C)=>C instanceof K?!1:b<3}),{data:g=[],isLoading:U,error:A}=S({queryKey:["comments",e],queryFn:()=>$(e)}),L=te({mutationFn:b=>Y(e,b),onSuccess:b=>{r.setQueryData(["comments",e],C=>{const V={...b,id:Date.now(),postId:e};return[...C||[],V]}),l({name:"",email:"",body:""})}}),Q=b=>{L.mutate(b)};return h||N||U?t.jsx(H,{}):y?t.jsx(O,{message:"Erro ao carregar o post. Por favor, tente novamente mais tarde."}):d instanceof K?t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:t.jsxs("div",{className:"max-w-3xl mx-auto",children:[t.jsx(F,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Autor não encontrado"}),t.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Desculpe, não conseguimos encontrar o autor deste post."})]})]})}):d||A?t.jsx(O,{message:"Ocorreu um erro ao carregar os dados. Por favor, tente novamente mais tarde."}):i?t.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4",children:t.jsxs("div",{className:"max-w-3xl mx-auto",children:[t.jsx(F,{to:"/",className:"text-blue-500 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 mb-4 inline-block",children:"← Voltar para a lista"}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4",children:i.title}),f&&t.jsxs("div",{className:"mb-4",children:[t.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:["Por: ",f.name]}),t.jsx("p",{className:"text-gray-500 dark:text-gray-500 text-sm",children:f.email})]}),t.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:i.body})]}),t.jsxs("section",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[t.jsxs("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white mb-6",children:["Comentários (",g.length,")"]}),t.jsx(se,{comment:a,onChange:l,onSubmit:Q,isLoading:L.isPending}),t.jsx(re,{comments:g})]})]})}):t.jsx(O,{message:"Post não encontrado."})};export{oe as default};
